

;; ---

структура Користувач
  ідентифікатор
  є_ботом
  імʼя
  прізвище
  імʼя_користувача
  код_мови
  є_преміум
  додано_в_меню_вкладень
  може_приєднуватись_до_груп
  може_читати_всі_повідомлення_групи
  підтримує_інлайн_запити
кінець

дія КористувачСтворити_з_телеграм_обʼєкта(то) 
    якщо !то
      вернути пусто
    кінець
    вернути Користувач(
        ідентифікатор=то["id"],
        є_ботом=то["is_bot"],
        імʼя=то["first_name"],
        прізвище=то["last_name"],
        імʼя_користувача=то["username"],
        код_мови=то["language_code"],
        є_преміум=то["is_premium"],
        додано_в_меню_вкладень=то["added_to_attachment_menu"],
        може_приєднуватись_до_груп=то["can_join_groups"],
        може_читати_всі_повідомлення_групи=то["can_read_all_group_messages"],
        підтримує_інлайн_запити=то["supports_inline_queries"]
    )
кінець

дія Користувач.перетворити_на_телеграм_обʼєкт()
  (
    id=я.ідентифікатор,
    is_bot=я.є_ботом,
    first_name=я.імʼя,
    last_name=я.прізвище,
    username=я.імʼя_користувача,
    language_code=я.код_мови,
    is_premium=я.є_преміум,
    added_to_attachment_menu=я.додано_в_меню_вкладень,
    can_join_groups=я.може_приєднуватись_до_груп,
    can_read_all_group_messages=я.може_читати_всі_повідомлення_групи,
    supports_inline_queries=я.підтримує_інлайн_запити
  )
кінець

;; ---

структура Чат
  ідентифікатор текст
  тип
  назва
  імʼя_користувача
  імʼя
  прізвище
  активні_імена_користувачів
  ідентифікатор_призначеного_емодзі
  біографія
  має_приватні_пересилання
  приєднуйтесь_щоб_надсилати_повідомлення
  приєднання_за_запитом
  опис
  посилання_запрошення
  затримка_у_повільному_режимі
  час_автоматичного_видалення_повідомлення
  ввімкнено_агресивний_антиспам
  є_приховані_учасники
  має_захищений_контент
  ідентифікатор_повʼязаного_чату
  назва_типу = "Chat"
кінець

дія ЧатСтворити_з_телеграм_обʼєкта(то) Чат або пусто
  якщо !то
    вернути пусто
  кінець
  вернути Чат(
    ідентифікатор=то["id"] як текст,
    тип=то["type"],
    назва=то["title"],
    імʼя_користувача=то["username"],
    імʼя=то["first_name"],
    прізвище=то["last_name"],
    активні_імена_користувачів=то["active_usernames"],
    ідентифікатор_призначеного_емодзі=то["emoji_status_custom_emoji_id"],
    біографія=то["bio"],
    має_приватні_пересилання=то["has_private_forwards"],
    приєднуйтесь_щоб_надсилати_повідомлення=то["join_to_send_messages"],
    приєднання_за_запитом=то["join_by_request"],
    опис=то["description"],
    посилання_запрошення=то["invite_link"],
    затримка_у_повільному_режимі=то["slow_mode_delay"],
    час_автоматичного_видалення_повідомлення=то["message_auto_delete_time"],
    ввімкнено_агресивний_антиспам=то["has_aggressive_anti_spam_enabled"],
    є_приховані_учасники=то["has_hidden_members"],
    має_захищений_контент=то["has_protected_content"],
    ідентифікатор_повʼязаного_чату=то["linked_chat_id"]
  )
кінець

дія Чат.перетворити_на_телеграм_обʼєкт()
  (
    id=я.ідентифікатор,
    type=я.тип,
    title=я.назва,
    username=я.імʼя_користувача,
    first_name=я.імʼя,
    last_name=я.прізвище,
    active_usernames=я.активні_імена_користувачів,
    emoji_status_custom_emoji_id=я.ідентифікатор_призначеного_емодзі,
    bio=я.біографія,
    has_private_forwards=я.має_приватні_пересилання,
    join_to_send_messages=я.приєднуйтесь_щоб_надсилати_повідомлення,
    join_by_request=я.приєднання_за_запитом,
    description=я.опис,
    invite_link=я.посилання_запрошення,
    slow_mode_delay=я.затримка_у_повільному_режимі,
    message_auto_delete_time=я.час_автоматичного_видалення_повідомлення,
    has_aggressive_anti_spam_enabled=я.ввімкнено_агресивний_антиспам,
    has_hidden_members=я.є_приховані_учасники,
    has_protected_content=я.має_захищений_контент,
    linked_chat_id=я.ідентифікатор_повʼязаного_чату
  )
кінець

;; ---

структура Повідомлення
  ідентифікатор_повідомлення
  ідентифікатор_теми_повідомлення
  від
  дата
  чат Чат
  відправник_переслання
  чат_відправника_переслання
  ідентифікатор_повідомлення_відправника_переслання
  ідентифікатор_медіагрупи
  текст
  сутності
  документ
  фото
  назва_типу = "Message"
кінець

дія ПовідомленняСтворити_з_телеграм_обʼєкта(то) Повідомлення або пусто
  якщо !то
    вернути пусто
  кінець
  вернути Повідомлення(
    ідентифікатор_повідомлення=то["message_id"],
    ідентифікатор_теми_повідомлення=то["message_thread_id"],
    від=КористувачСтворити_з_телеграм_обʼєкта(то["from"]),
    дата=то["date"],
    чат=ЧатСтворити_з_телеграм_обʼєкта(то["chat"]) як Чат,
    відправник_переслання=КористувачСтворити_з_телеграм_обʼєкта(то["forward_from"]),
    чат_відправника_переслання=ЧатСтворити_з_телеграм_обʼєкта(то["forward_from_chat"]),
    ідентифікатор_повідомлення_відправника_переслання=то["forward_from_message_id"],
    через_бота=КористувачСтворити_з_телеграм_обʼєкта(то["via_bot"]),
    має_захищений_контент=то["has_protected_content"],
    ідентифікатор_медіагрупи=то["media_group_id"],
    текст=то["text"],
    сутності=то["entities"],
    документ=ДокументСтворити_з_телеграм_обʼєкта(то["document"]),
    фото=то["photo"]
  )
кінець

дія Повідомлення.перетворити_на_телеграм_обʼєкт()
  (
    message_id=я.ідентифікатор_повідомлення,
    message_thread_id=я.ідентифікатор_теми_повідомлення,
    from=я.від,
    date=я.дата,
    chat=я.чат,
    media_group_id=я.ідентифікатор_медіагрупи,
    text=я.текст,
    entities=я.сутності,
    document=я.документ,
    photo=я.фото
  )
кінець

;; ---

структура Документ
  ідентифікатор_файлу
  унікальний_ідентифікатор_файлу
  імʼя_файлу
  мімтип
  розмір_файлу
  назва_типу = "Document"
кінець

дія ДокументСтворити_з_телеграм_обʼєкта(то) Документ або пусто
    якщо !то
      вернути пусто
    кінець
    вернути Документ(
        ідентифікатор_файлу=то["file_id"],
        унікальний_ідентифікатор_файлу=то["file_unique_id"],
        імʼя_файлу=то["file_name"],
        мімтип=то["mime_type"],
        розмір_файлу=то["file_size"]
    )
кінець

дія Документ.перетворити_на_телеграм_обʼєкт()
  (
    file_id=я.ідентифікатор_файлу,
    file_unique_id=я.унікальний_ідентифікатор_файлу,
    file_name=я.імʼя_файлу,
    mime_type=я.мімтип,
    file_size=я.розмір_файлу
  )
кінець

структура Оновлення
  ідентифікатор_оновлення число
  повідомлення Повідомлення або пусто
кінець

дія ОновленняСтворити_з_телеграм_обʼєкта(то) Оновлення або пусто
    якщо !то
      вернути пусто
    кінець
    вернути Оновлення(
        ідентифікатор_оновлення=то["update_id"] як число,
        повідомлення=ПовідомленняСтворити_з_телеграм_обʼєкта(то["message"])
    )
кінець

;; ---

дати Оновлення
дати Повідомлення
дати Чат
дати ОновленняСтворити_з_телеграм_обʼєкта